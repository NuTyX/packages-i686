description="Library for synchronization between TeX files and resulting file"
url="https://tug.org/texlive/"

packager="tnut <tnut@nutyx.org>"
contributors=""

makedepends=(gmp mpfr cairo icu xorg-pixman xorg-libxaw)

name=libsynctex
version=20210325

source=(http://www.linuxfromscratch.org/patches/blfs/svn/texlive-$version-upstream_fixes-1.patch
        ftp://tug.org/texlive/historic/2021/texlive-$version-source.tar.xz)

prepare() {
cd texlive-$version-source
export TEXARCH=$(uname -m |
 sed -e 's/i.86/i386/' -e 's/$/-linux/')

patch -Np1 -i ../texlive-$version-upstream_fixes-1.patch
mkdir build
}


build() {
cd texlive-$version-source/build
../configure --prefix=/usr \
--mandir=/usr/share/man \
--infodir=/usr/share/info \
--with-system-zlib \
--with-system-pixman \
--with-system-cairo \
--with-system-icu \
--with-system-gmp \
--with-system-mpfr \
--disable-native-texlive-build \
--disable-static \
--enable-shared \
--disable-dvisvgm
make
make -C texk/web2c
make -C texk/web2c DESTDIR=$PKG \
install-data-am install-libLTLIBRARIES
}
